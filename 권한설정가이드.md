# Apps Script 권한 설정 가이드

## 🚨 권한 오류 해결방법

### 방법 1: 매니페스트 파일 수동 추가
1. Apps Script에서 **설정(톱니바퀴 아이콘)** 클릭
2. **"appsscript.json" 매니페스트 파일을 편집기에서 표시** 체크
3. 좌측에 `appsscript.json` 파일이 나타남
4. 다음 내용으로 교체:

```json
{
  "timeZone": "Asia/Seoul",
  "dependencies": {},
  "exceptionLogging": "STACKDRIVER",
  "runtimeVersion": "V8",
  "oauthScopes": [
    "https://www.googleapis.com/auth/spreadsheets",
    "https://www.googleapis.com/auth/drive.file", 
    "https://www.googleapis.com/auth/gmail.send",
    "https://www.googleapis.com/auth/script.external_request"
  ]
}
```

### 방법 2: 코드에서 직접 권한 요청
테스트 함수를 실행하여 권한을 강제로 요청:

```javascript
function forcePermissions() {
  // 모든 권한을 사용하는 코드를 실행하여 권한 요청 트리거
  SpreadsheetApp.getActiveSpreadsheet();
  DriveApp.getRootFolder();
  GmailApp.getInboxThreads(0, 1);
  UrlFetchApp.fetch('https://www.google.com');
  console.log('모든 권한 요청 완료');
}
```

### 방법 3: 프로젝트 재생성 (최후의 수단)
1. 새로운 Apps Script 프로젝트 생성
2. `appsscript.json` 먼저 생성 후 권한 설정
3. 이후 `Code.js` 코드 추가

## ⚡ 즉시 시도할 수 있는 방법
Apps Script에서 다음 함수를 실행:
```javascript
function testPermissions() {
  console.log('권한 테스트 시작');
  UrlFetchApp.fetch('https://www.google.com');
  console.log('외부 요청 권한 OK');
}
```